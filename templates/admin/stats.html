{% extends 'base.html' %}

{% block head %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
<script type="module" src="{{url_for('static', filename='js/stats.js') }}"></script>
<link rel="stylesheet" type= "text/css" href="{{url_for('static', filename='stylesheets/stats.css')}}">
{% endblock %}

{% block content %}

<div id="app">
    <div class="box-wrapper">
        <div class="box">
            <div class="stats">
                <div class="stats__amount">[[totals.users]]</div>
                <div class="stats__caption">users</div>
                <div class="stats__change positive">+[[weekly.user_change]] <span style="font-weight:normal;color: white;">since last week</span></div>
                <div class="stats__change mid">[[totals.pct_goog_users]]% <span style="font-weight:normal;color: white;">google sign-ups</span></div>
            </div>
        </div>

        <div class="box">
            <div class="stats">
                <div class="stats__amount">[[totals.runs]]</div>
                <div class="stats__caption">runs</div>
                <div class="stats__change positive">+[[weekly.runs_change]] <span style="font-weight:normal;color: white;">since last week</span></div>
                <div class="stats__change mid">[[totals.pct_user_runs]]% <span style="font-weight:normal;color: white;">registered users</span></div>
            </div>
        </div>
    
        <div class="box">
            <div class="stats">
                <div class="stats__amount">[[totals.finished_runs]]</div>
                <div class="stats__caption">finished runs</div>
                <div class="stats__change positive">+[[weekly.finished_runs_change]] <span style="font-weight:normal;color: white;">since last week</span></div>
                <div class="stats__change mid">[[totals.pct_user_finished_runs]]% <span style="font-weight:normal;color: white;">registered users</span></div>
            </div>
        </div>
    </div>

    <div class="box-wrapper">
        <div class="box">
            <div class="stats">
                <div class="stats__amount">[[totals.marathon_runs]]</div>
                <div class="stats__caption">marathons</div>
                <!-- <div class="stats__change positive">+[[weekly.marathons_change]] <span style="font-weight:normal;color: white;">since last week</span></div> -->
                <div class="stats__change mid">[[totals.pct_user_marathons]]% <span style="font-weight:normal;color: white;">registered users</span></div>
            </div>
        </div>

        <div class="box">
            <div class="stats">
                <div class="stats__amount">[[totals.finished_marathons]]</div>
                <div class="stats__caption">finished marathons</div>
                <!-- <div class="stats__change positive">+[[weekly.finished_marathons_change]] <span style="font-weight:normal;color: white;">since last week</span></div> -->
                <div class="stats__change mid">[[totals.pct_user_finished_marathons]]% <span style="font-weight:normal;color: white;">registered users</span></div>
            </div>
        </div>

        <div class="box">
            <div class="stats">
                <div class="stats__amount">[[totals.created_lobbies]]</div>
                <div class="stats__caption">created lobbies</div>
                <div class="stats__change positive">+[[weekly.lobbies_change]] <span style="font-weight:normal;color: white;">since last week</span></div>
            </div>
        </div>
    </div>

    <ul class="nav nav-pills" id="stats-tabs" @click.prevent>
        <li class="nav-item">
            <a class="nav-link" @click="set_active('player_growth')" :class="{active: is_active('player_growth')}">Player Growth</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" @click="set_active('sprints')" :class="{active: is_active('sprints')}">Sprints</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" @click="set_active('lobbies')" :class="{active: is_active('lobbies')}">Lobbies</a>
        </li>
    </ul>

    <div class="tab-content">
        <div class="tab-pane fade" :class="{'active show': is_active('player_growth')}">
            <div class="col-xs-6">
                <canvas id="daily-users" width="400" height="450"></canvas>
            </div>
            
            <div class="col-xs-6">
                <canvas id="daily-new-users" width="400" height="450"></canvas>
            </div>
        </div>

        <div class="tab-pane fade" :class="{'active show': is_active('sprints')}">
            <div class="col-xs-6">
                <canvas id="daily-runs" width="400" height="450"></canvas>
            </div>
        
            <div class="col-xs-6">
                <canvas id="daily-new-runs" width="400" height="450"></canvas>
            </div>
        
            <div class="col-xs-6">
                <canvas id="daily-active-users" width="400" height="450"></canvas>
            </div>
        
            <div class="col-xs-6">
                <canvas id="daily-average-user-plays" width="400" height="450"></canvas>
            </div>
        
        </div>

        <div class="tab-pane fade" :class="{'active show': is_active('lobbies')}">
            <div class="col-xs-6">
                <canvas id="daily-lobbies" width="400" height="450"></canvas>
            </div>
        
            <div class="col-xs-6">
                <canvas id="daily-new-lobbies" width="400" height="450"></canvas>
            </div>

            <div class="col-xs-6">
                <canvas id="daily-lobby-runs" width="400" height="450"></canvas>
            </div>

            <div class="col-xs-6">
                <canvas id="daily-new-lobby-runs" width="400" height="450"></canvas>
            </div>

            <div class="col-xs-6">
                <canvas id="daily-active-lobby-users" width="400" height="450"></canvas>
            </div>

            <div class="col-xs-6">
                <canvas id="daily-average-lobby-user-plays" width="400" height="450"></canvas>
            </div>
        </div>
    </div>
</div>
{% endblock %}
