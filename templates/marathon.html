{% extends 'base.html' %}

{% block head %}

<link rel="stylesheet" type= "text/css" href="{{url_for('static', filename='stylesheets/wikipedia.css')}}">
<link rel="stylesheet" type= "text/css" href="{{url_for('static', filename='stylesheets/play.css')}}">
<script type="module" src="{{url_for('static', filename='js/marathon.js')}}"></script>

{% endblock %}

{% block content %}

<div id="app">

    <div v-show="started && !finished" id="time-box" class="HUDwrapper container" v-cloak>
        <div class="row flex-row flex-nowrap py-2">
            <div class="col-sm-auto px-4">
                Start Article<br><strong>[[startArticle]]</strong>
            </div>
            <div class="col-sm-auto px-4">
                Clicks Remaining<br><strong class="text-size-3" v-bind:class="clicksRemaining < 4 ? 'color: red' : ''">[[clicksRemaining]]</strong>
            </div>
            <div class="col-sm px-4">
                Checkpoints Visited<br>[[numCheckpointsVisited]]
                <br>Unique Articles Visited<br>[[numVisitedUnique]]
                <br>[[elapsed]] s
            </div>
            <div class="col-lg-auto px-4">
                Checkpoints<br><span v-html="formatActiveCheckpoints()"></span>
            </div>
        </div>
        <div class="row flex-row flex-nowrap justify-content-end py-2">
            <div class="col-sm-auto">
                <button v-on:click="showHelp = !showHelp" class="btn btn-outline-secondary mt-auto" style="font-size: 0.75rem">Help</button>
            </div>
            <div class="col-sm-auto">
                <button v-on:click="saveRun()" class="btn btn-outline-secondary mt-auto" style="font-size: 0.75rem">Save and Quit</button>
            </div>
            <div class="col-sm-auto">
                <button v-on:click="finish(0)" class="btn btn-outline-secondary mt-auto" style="font-size: 0.75rem">End my suffering</button>
            </div> 
        </div>
    </div>

    <div v-show="started && !finished && showHelp" id="help-box" class="HUDwrapper container" v-cloak>
        <div class="row flex-row flex-nowrap">
            <div class="col-9 px-4 py-2">
            <p><strong>NEW Marathon gamemode</strong></p>
            <p>In this new game mode, your objective is to go as far as you can with the limited amount of "clicks". 
                You will have 5 checkpoints that you can visit in any order. 
                Each checkpoint you manage to reach will give you 5 more clicks, and also give you a new checkpoint. 
                However, clicking on any link will cost 1 click. The game ends when you run out of clicks.</p>
                <p>Your score will depend on the total number of checkpoints you reach and the total number of unique articles you visit. You will be timed, but it will not factor into your score.</p>
                <p>You may forfeit your game at any point, and your progres thus far will be submitted as a complete run.</p>
                <p>Good luck!</p>
            <p></p>

            </div>
            <div class="col py-2 d-flex flex-row justify-content-end">
                <button v-on:click="showHelp = !showHelp" class="btn btn-outline-secondary mt-auto align-self-end">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
        </div>
    </div>

    <countdown-timer
        v-bind:start-article="startArticle"
        v-bind:active-checkpoints="activeCheckpoints"
        v-on:start-game="start"
    ></countdown-timer>

    <finish-page
        v-bind:forfeited="forfeited"
        v-bind:start-article="startArticle"
        v-bind:final-time="endTime - startTime"
        v-bind:num-visited-unique="numVisitedUnique"
        v-bind:num-checkpoints-visited="numCheckpointsVisited"
        v-bind:active-checkpoints="activeCheckpoints"
        v-bind:prompt-id="promptId"
        v-bind:run-id="runId"
        v-bind:path="path"
        v-bind:saved="saved"

        v-show="finished"
    ></finish-page>


    <div v-show="started && !finished" id="main">
        <div id="wikipedia-frame"></div>
    </div>

</div>
{% endblock %}
